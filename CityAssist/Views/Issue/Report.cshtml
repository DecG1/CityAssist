@model CityAssist.Models.ReportViewModel
@{
    ViewData["Title"] = "Report an Issue";
}

<div class="container mt-4 report-page">
    <div class="row align-items-center mb-4">
        <div class="col-md-4">
            <a class="btn btn-outline-light" href="@Url.Action("Index", "Home")">← Back to Main Menu</a>
        </div>
        <div class="col-md-4 text-center">
            <h2 class="text-light">Report an Issue</h2>
        </div>
        <div class="col-md-4"></div>
    </div>

    <div class="row report-layout">
       
        <div class="report-form">
            <form method="post" enctype="multipart/form-data" asp-action="Report" asp-controller="Issue">
                <div class="form-group">
                    <label for="Location"> Location</label>
                    <input type="text" class="form-control" id="Location" name="Location" placeholder="Enter location" required />
                </div>

                <div class="form-group">
                    <label for="Category"> Category</label>
                    <select class="form-control" id="Category" name="Category">
                        <option value="Water">Water</option>
                        <option value="Electricity">Electricity</option>
                        <option value="Roads">Roads</option>
                        <option value="Safety">Safety</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="Description"> Description</label>
                    <textarea class="form-control" id="Description" name="Description" rows="4" placeholder="Describe the issue..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="Media"> Attach Media</label>
                    <input type="file" class="form-control" id="Media" name="Media" />
                </div>

                <div class="form-check my-3">
                    <input type="checkbox" class="form-check-input" id="NotifyMe" name="Notification" />
                    <label class="form-check-label text-light" for="NotifyMe">Notify me of status updates</label>
                </div>

                <button type="submit" class="btn btn-success w-100"> Submit Report</button>
            </form>
        </div>

      
        <div class="report-list">
            <h4 class="text-light mb-3"> Your Submitted Reports</h4>

            @if (Model.ExistingReports.Any())
            {
                <ul class="list-group">
                    @foreach (var r in Model.ExistingReports)
                    {
                        var statusClass = r.Status?.ToLower() switch
                        {
                            "received" => "bg-secondary",
                            "in progress" => "bg-warning text-dark",
                            "resolved" => "bg-success",
                            _ => "bg-light text-dark"
                        };

                        <li class="list-group-item report-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>@(string.IsNullOrWhiteSpace(r.Category) ? "N/A" : r.Category)</strong><br />
                                    <small>@(string.IsNullOrWhiteSpace(r.Description) ? "No description" : r.Description)</small><br />
                                    <small class="text-muted">📅 @r.SubmitTime.ToString("yyyy/MM/dd HH:mm")</small>
                                </div>
                                <span class="badge @statusClass">Status: @r.Status</span>
                            </div>
                        </li>
                    }
                </ul>
            }
            else
            {
                <p class="text-light">No reports submitted yet.</p>
            }
        </div>
    </div>
</div>
